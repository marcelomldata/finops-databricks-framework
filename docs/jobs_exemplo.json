{
  "name": "FinOps - Coleta Di√°ria",
  "email_notifications": {
    "on_success": [],
    "on_failure": ["admin@company.com"]
  },
  "timeout_seconds": 3600,
  "max_concurrent_runs": 1,
  "schedule": {
    "quartz_cron_expression": "0 0 0 * * ?",
    "timezone_id": "UTC",
    "pause_status": "UNPAUSED"
  },
  "tasks": [
    {
      "task_key": "collect_compute",
      "notebook_task": {
        "notebook_path": "/notebooks/01_collect/01_collect_compute",
        "base_parameters": {
          "WORKSPACE_NAME": "workspace_prod",
          "WORKSPACE_URL": "https://adb-xxxxx.azuredatabricks.net"
        }
      },
      "new_cluster": {
        "spark_version": "13.3.x-scala2.12",
        "node_type_id": "Standard_DS3_v2",
        "num_workers": 2,
        "spark_conf": {
          "spark.databricks.cluster.profile": "singleNode",
          "spark.master": "local[*]"
        }
      },
      "timeout_seconds": 1800
    },
    {
      "task_key": "collect_storage",
      "notebook_task": {
        "notebook_path": "/notebooks/01_collect/02_collect_storage",
        "base_parameters": {
          "WORKSPACE_NAME": "workspace_prod",
          "WORKSPACE_URL": "https://adb-xxxxx.azuredatabricks.net"
        }
      },
      "depends_on": [
        {
          "task_key": "collect_compute"
        }
      ],
      "existing_cluster_id": "${var.cluster_id}",
      "timeout_seconds": 3600
    },
    {
      "task_key": "collect_billing",
      "notebook_task": {
        "notebook_path": "/notebooks/01_collect/03_collect_billing",
        "base_parameters": {
          "WORKSPACE_NAME": "workspace_prod",
          "WORKSPACE_URL": "https://adb-xxxxx.azuredatabricks.net",
          "BILLING_DAYS_BACK": "30"
        }
      },
      "depends_on": [
        {
          "task_key": "collect_storage"
        }
      ],
      "existing_cluster_id": "${var.cluster_id}",
      "timeout_seconds": 1800
    }
  ]
}
